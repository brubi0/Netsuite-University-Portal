<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Appendix A: Formula Reference - Suite Analytics Learning Hub</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: #0f0f1a; color: #e0e0e0; line-height: 1.7; }
        .header { background: linear-gradient(135deg, #0f3460 0%, #533483 100%); padding: 30px 20px; }
        .header-content { max-width: 1000px; margin: 0 auto; }
        .breadcrumb { font-size: 0.9em; margin-bottom: 10px; opacity: 0.8; }
        .breadcrumb a { color: #fff; text-decoration: none; }
        h1 { font-size: 2em; font-weight: 700; color: #fff; }
        .container { max-width: 1000px; margin: 0 auto; padding: 40px 20px; }
        h2 { color: #e94560; font-size: 1.5em; margin: 40px 0 20px; padding-bottom: 10px; border-bottom: 2px solid #e94560; }
        h3 { color: #533483; font-size: 1.2em; margin: 25px 0 15px; }
        p { margin-bottom: 15px; }
        .intro-box { background: linear-gradient(145deg, #1a1a2e 0%, #1e1e32 100%); border-radius: 15px; padding: 25px; margin: 25px 0; border-left: 4px solid #e94560; }
        .intro-box h4 { color: #e94560; margin-bottom: 12px; }
        .formula-card { background: #1a1a2e; border-radius: 12px; padding: 20px; margin: 15px 0; border: 1px solid #333; }
        .formula-card h4 { color: #4caf50; margin-bottom: 10px; font-size: 1em; }
        .formula-card .code { background: #0d0d15; border-radius: 8px; padding: 15px; margin: 10px 0; font-family: 'Fira Code', monospace; font-size: 0.9em; color: #4caf50; overflow-x: auto; }
        .formula-card .desc { font-size: 0.9em; opacity: 0.8; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #333; }
        th { background: rgba(233,69,96,0.2); color: #e94560; font-weight: 600; }
        .nav-buttons { display: flex; justify-content: space-between; margin-top: 50px; padding-top: 30px; border-top: 1px solid #333; flex-wrap: wrap; gap: 15px; }
        .nav-btn { padding: 12px 25px; border-radius: 25px; text-decoration: none; font-weight: 600; font-size: 0.9em; transition: all 0.3s ease; }
        .nav-btn.secondary { background: rgba(255,255,255,0.1); color: #fff; }
        .nav-btn.primary { background: linear-gradient(135deg, #e94560 0%, #533483 100%); color: #fff; }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="breadcrumb">
                <a href="../Master-Dashboard.html">Course Overview</a> / Appendix A
            </div>
            <h1>üßÆ Appendix A: Formula Reference</h1>
        </div>
    </div>

    <div class="container">
        <div class="intro-box">
            <h4>About Formulas</h4>
            <p>NetSuite saved searches support SQL-based formulas for calculated fields. Use formulas in both Criteria (filters) and Results (columns) to create custom calculations, text manipulation, and conditional logic.</p>
        </div>

        <h2>Date Formulas</h2>

        <div class="formula-card">
            <h4>Days Since Date</h4>
            <div class="code">{today} - {trandate}</div>
            <div class="desc">Calculate days between today and transaction date.</div>
        </div>

        <div class="formula-card">
            <h4>Days Overdue</h4>
            <div class="code">TRUNC({today}) - NVL({duedate}, {trandate})</div>
            <div class="desc">Days past due date (uses transaction date if no due date).</div>
        </div>

        <div class="formula-card">
            <h4>Contract Age in Days</h4>
            <div class="code">ABS({startdate} - NVL({canceldate}, {today}))</div>
            <div class="desc">Days from start to cancel date (or today if not canceled).</div>
        </div>

        <h2>Text Formulas</h2>

        <div class="formula-card">
            <h4>Concatenate Address</h4>
            <div class="code">{city} || ', ' || {state} || ' ' || {zipcode}</div>
            <div class="desc">Combine city, state, and zip into one field.</div>
        </div>

        <div class="formula-card">
            <h4>Extract Email Domain</h4>
            <div class="code">SUBSTR({email}, INSTR({email}, '@') + 1)</div>
            <div class="desc">Get domain portion of email address.</div>
        </div>

        <h2>Conditional Formulas (CASE WHEN)</h2>

        <div class="formula-card">
            <h4>AR Aging Buckets</h4>
            <div class="code">CASE 
  WHEN TRUNC({today}) - NVL({duedate},{trandate}) BETWEEN 1 AND 30 
    THEN {fxamount} - {fxamountpaid}
  ELSE 0 
END</div>
            <div class="desc">Calculate amount in 1-30 days aging bucket.</div>
        </div>

        <div class="formula-card">
            <h4>Traffic Light Status</h4>
            <div class="code">CASE 
  WHEN {quantity} > 20 THEN 'Green'
  WHEN {quantity} > 10 THEN 'Yellow'
  ELSE 'Red'
END</div>
            <div class="desc">Color code based on quantity thresholds.</div>
        </div>

        <div class="formula-card">
            <h4>Markup Percentage</h4>
            <div class="code">({price} - {cost}) / NULLIF({cost}, 0) * 100</div>
            <div class="desc">Calculate markup % (handles divide by zero).</div>
        </div>

        <h2>Common SQL Functions</h2>

        <table>
            <thead><tr><th>Function</th><th>Purpose</th><th>Example</th></tr></thead>
            <tbody>
                <tr><td>NVL(a, b)</td><td>Return b if a is null</td><td>NVL({duedate}, {trandate})</td></tr>
                <tr><td>NULLIF(a, b)</td><td>Return null if a = b</td><td>NULLIF({cost}, 0)</td></tr>
                <tr><td>TRUNC(date)</td><td>Remove time from date</td><td>TRUNC({today})</td></tr>
                <tr><td>ABS(n)</td><td>Absolute value</td><td>ABS({balance})</td></tr>
                <tr><td>ROUND(n, d)</td><td>Round to d decimals</td><td>ROUND({rate}, 2)</td></tr>
                <tr><td>UPPER(s)</td><td>Convert to uppercase</td><td>UPPER({name})</td></tr>
                <tr><td>SUBSTR(s, start, len)</td><td>Extract substring</td><td>SUBSTR({phone}, 1, 3)</td></tr>
                <tr><td>INSTR(s, find)</td><td>Position of substring</td><td>INSTR({email}, '@')</td></tr>
                <tr><td>TO_CHAR(d, fmt)</td><td>Format date as text</td><td>TO_CHAR({trandate}, 'YYYY-MM')</td></tr>
            </tbody>
        </table>

        <div class="nav-buttons">
            <a href="../Master-Dashboard.html" class="nav-btn secondary">‚Üê Course Overview</a>
            <a href="Appendix-B-Date-Filters.html" class="nav-btn primary">Next: Date Filters ‚Üí</a>
        </div>
    </div>
</body>
</html>
