<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Module 16: Interactive Scheduler UI - SuiteScript Learning Hub</title><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet"><style>:root{--primary-gradient:linear-gradient(135deg,#667eea 0%,#764ba2 100%);--dark-bg:#1a1a2e;--card-bg:#16213e;--text-primary:#ffffff;--text-secondary:#a0aec0;--border-color:rgba(255,255,255,0.1);--purple:#9f7aea;--success:#48bb78;--code-bg:#0d1117}*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Inter',sans-serif;background:var(--dark-bg);color:var(--text-primary);min-height:100vh;line-height:1.7}.nav-bar{background:var(--card-bg);padding:15px 20px;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:100}.nav-bar a{color:var(--purple);text-decoration:none}.header{background:var(--primary-gradient);padding:50px 20px}.header-content{max-width:900px;margin:0 auto}.header .module-tag{display:inline-block;background:rgba(255,255,255,0.2);padding:5px 12px;border-radius:20px;font-size:0.85rem;margin-bottom:15px}.header h1{font-size:2.2rem;margin-bottom:10px}.header p{font-size:1.1rem;opacity:0.9}.container{max-width:900px;margin:0 auto;padding:40px 20px}.content-section{margin-bottom:40px}.content-section h2{font-size:1.5rem;margin-bottom:20px;padding-bottom:10px;border-bottom:2px solid var(--border-color)}.content-section h3{font-size:1.2rem;margin:25px 0 15px 0;color:var(--purple)}.content-section p{margin-bottom:15px;color:var(--text-secondary)}.info-box{border-radius:10px;padding:20px;margin:20px 0;background:rgba(72,187,120,0.15);border:1px solid rgba(72,187,120,0.3)}.info-box h4{margin-bottom:10px}.info-box p{margin-bottom:0;font-size:0.95rem}pre{background:var(--code-bg);border-radius:10px;padding:20px;overflow-x:auto;margin:20px 0;border:1px solid var(--border-color)}code{font-family:'JetBrains Mono',monospace;font-size:0.85rem;line-height:1.6}.inline-code{background:var(--code-bg);padding:2px 8px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:0.85rem;color:var(--purple)}.key-takeaways{background:var(--card-bg);border-radius:12px;padding:25px;margin-top:40px;border:1px solid var(--border-color)}.key-takeaways h3{margin-bottom:15px}.key-takeaways ul{list-style:none}.key-takeaways li{padding:8px 0;padding-left:25px;position:relative;color:var(--text-secondary)}.key-takeaways li::before{content:'‚úì';position:absolute;left:0;color:var(--success)}.nav-footer{display:flex;justify-content:space-between;margin-top:50px;padding-top:30px;border-top:1px solid var(--border-color);flex-wrap:wrap;gap:10px}.nav-footer a{color:var(--purple);text-decoration:none}</style></head><body><nav class="nav-bar"><a href="week-8-dashboard.html">‚Üê Week 8 Dashboard</a><div style="display:flex;gap:15px"><a href="Module-15-Practical-CSV-Export.html">‚Üê Module 15</a><a href="../Appendix-A-Code-Examples.html">Appendices ‚Üí</a></div></nav><header class="header"><div class="header-content"><span class="module-tag">Week 8 ‚Ä¢ Module 16</span><h1>Practical Example: Scheduler UI</h1><p>Interactive Suitelet with real-time task status tracking</p></div></header><main class="container"><section class="content-section"><h2>üéØ Project Overview</h2><p>Build an interactive Suitelet that:</p><ul style="list-style:disc;margin-left:25px;color:var(--text-secondary);margin-bottom:20px"><li>Displays a form with saved search selector</li><li>Shows a confirmation dialog before submission</li><li>Triggers a Map/Reduce script via N/task</li><li>Polls for task status using setInterval</li><li>Displays real-time progress with messages</li></ul></section><section class="content-section"><h2>üìã Suitelet Form</h2><pre><code>function onRequest(context) {
    if (context.request.method === 'GET') {
        const form = serverWidget.createForm({ title: 'Run Report' });
        
        // Saved search selector
        form.addField({
            id: 'custpage_search',
            type: serverWidget.FieldType.SELECT,
            label: 'Customer Search',
            source: 'search'
        });
        
        // Status display (INLINEHTML for custom content)
        form.addField({
            id: 'custpage_status',
            type: serverWidget.FieldType.INLINEHTML,
            label: ' '
        }).defaultValue = '&lt;div id="statusArea"&gt;&lt;/div&gt;';
        
        form.addSubmitButton({ label: 'Run Report' });
        form.clientScriptModulePath = './scheduler_cs.js';
        
        context.response.writePage(form);
    } else {
        // Handle POST - schedule the task
        const searchId = context.request.parameters.custpage_search;
        
        const mrTask = task.create({
            taskType: task.TaskType.MAP_REDUCE,
            scriptId: 'customscript_csv_export_mr',
            params: { custscript_customer_search: searchId }
        });
        
        const taskId = mrTask.submit();
        
        // Return task ID for status polling
        context.response.write(JSON.stringify({ taskId: taskId }));
    }
}</code></pre></section><section class="content-section"><h2>üé® Client Script with Status Polling</h2><pre><code>function pageInit(context) {
    // Attach to form submit
}

function saveRecord(context) {
    // Confirm before submitting
    return dialog.confirm({
        title: 'Confirm',
        message: 'Run the export now?'
    }).then(result => {
        if (result) {
            submitAndPoll();
        }
        return false; // Prevent normal form submit
    });
}

function submitAndPoll() {
    const statusDiv = document.getElementById('statusArea');
    
    // Show processing message
    const msg = message.create({
        title: 'Processing',
        message: 'Report generation started...',
        type: message.Type.INFORMATION
    });
    msg.show();
    
    // Poll for status every 3 seconds
    const interval = setInterval(() => {
        fetch(suiteletUrl + '&action=status&taskId=' + taskId)
            .then(response => response.json())
            .then(data => {
                if (data.status === 'COMPLETE') {
                    clearInterval(interval);
                    msg.hide();
                    message.create({
                        title: 'Complete',
                        message: 'Report generated successfully!',
                        type: message.Type.CONFIRMATION
                    }).show();
                } else if (data.status === 'FAILED') {
                    clearInterval(interval);
                    msg.hide();
                    message.create({
                        title: 'Error',
                        message: 'Report generation failed.',
                        type: message.Type.ERROR
                    }).show();
                }
            });
    }, 3000);
}</code></pre></section><section class="content-section"><h2>üìä Status Check Endpoint</h2><pre><code>// In the Suitelet, handle status check action
if (context.request.parameters.action === 'status') {
    const taskId = context.request.parameters.taskId;
    const status = task.checkStatus({ taskId: taskId });
    
    context.response.write(JSON.stringify({
        status: status.status
    }));
    return;
}</code></pre><div class="info-box"><h4>‚úÖ Pattern: Action Routing</h4><p>Use an "action" parameter to route different requests to the same Suitelet‚Äîdefault for form display, "schedule" for task creation, "status" for polling.</p></div></section><section class="content-section" style="background: rgba(66, 153, 225, 0.1); border: 1px solid rgba(66, 153, 225, 0.2); border-radius: 12px; padding: 25px; margin: 30px 0;">
            <h2 style="border: none; padding: 0; margin-bottom: 15px;">üìñ Finding This in the Docs</h2>
            <p>This capstone combines multiple modules. Key references:</p>
            <ol style="margin-left: 20px; color: var(--text-secondary);">
                <li style="margin-bottom: 8px;"><strong>Suitelet Script Type</strong> ‚Üí onRequest entry point, context.request/response</li>
                <li style="margin-bottom: 8px;"><strong>N/ui/serverWidget Module</strong> ‚Üí form building</li>
                <li style="margin-bottom: 8px;"><strong>N/task Module</strong> ‚Üí task.create(), task.checkStatus()</li>
                <li style="margin-bottom: 8px;"><strong>N/ui/message Module</strong> ‚Üí banner notifications</li>
            </ol>
            <p style="margin-top: 15px;"><strong>Key pages to bookmark:</strong></p>
            <ul style="margin-left: 20px; color: var(--text-secondary);">
                <li>Suitelet Script Type ‚Üí handling GET vs POST requests</li>
                <li>serverWidget.FieldType.INLINEHTML ‚Üí custom HTML in forms</li>
                <li>Form.clientScriptModulePath ‚Üí attaching client scripts</li>
                <li>N/ui/dialog Module ‚Üí dialog.confirm() for user prompts</li>
                <li>task.checkStatus() ‚Üí polling task progress</li>
            </ul>
        </section>

        <div class="key-takeaways"><h3>üéØ Key Takeaways</h3><ul><li>Combine serverWidget, N/task, and client scripts for interactive UIs</li><li>Use INLINEHTML fields for custom JavaScript-driven content</li><li>dialog.confirm() provides user confirmation before actions</li><li>setInterval + fetch enables real-time status polling</li><li>Action parameters route different requests to one Suitelet</li><li>message.create() displays status banners to users</li></ul></div><nav class="nav-footer"><a href="Module-15-Practical-CSV-Export.html">‚Üê Module 15: CSV Export</a><a href="../Appendix-A-Code-Examples.html">Appendix A: Code Examples ‚Üí</a></nav></main></body></html>
